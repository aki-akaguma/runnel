# Requirements

## Functional Requirements

1.  **Abstract I/O Streams:**
    *   The system shall provide traits for abstracting input, output, and error streams (`StreamIn`, `StreamOut`, `StreamErr`).
    *   These abstractions shall support common I/O operations like reading, writing, and iterating over lines.

2.  **Pluggable I/O Implementations:**
    *   The system shall allow different I/O mechanisms to be "plugged in" at runtime or compile time.
    *   A central struct (`RunnelIoe`) shall hold the configured input, output, and error streams.
    *   A builder pattern (`RunnelIoeBuilder`) shall be provided for easy construction and configuration of the I/O environment.

3.  **Standard I/O (stdio):**
    *   The system shall provide a default implementation that maps to the process's standard input (`stdin`), standard output (`stdout`), and standard error (`stderr`).

4.  **In-Memory String I/O (stringio):**
    *   The system shall provide an in-memory, string-based implementation for all I/O streams.
    *   This is primarily to facilitate testing of I/O-dependent application logic without interacting with the console or file system.

5.  **In-Memory Pipe I/O (pipeio):**
    *   The system shall provide an in-memory FIFO (First-In, First-Out) byte-stream implementation (`PipeIn`, `PipeOut`).
    *   This enables efficient, thread-safe communication between different parts of an application or between threads.

6.  **In-Memory Line-Pipe I/O (linepipeio):**
    *   The system shall provide an in-memory FIFO implementation optimized for passing text lines (as `String`) between threads.
    *   This offers a higher-level, more convenient API for line-oriented protocols compared to the raw byte pipe.

## Non-Functional Requirements

1.  **Thread Safety:**
    *   All stream implementations intended for concurrent use (e.g., `pipeio`, `linepipeio`) must be thread-safe.
    *   Access to shared I/O resources shall be properly synchronized.

2.  **Usability & Ergonomics:**
    *   The API shall be clear, well-documented, and provide examples for all major use cases.
    *   The builder pattern should make it intuitive to configure various I/O scenarios.

3.  **Extensibility:**
    *   The core traits (`StreamIn`, `StreamOut`, `StreamErr`) shall be public and implementable by users to create custom stream types.

4.  **Performance:**
    *   The in-memory pipe implementations should be efficient for inter-thread communication.
    *   The `linepipeio` should offer better performance for line-based messaging than manually framing lines over `pipeio`.

5.  **Dependencies:**
    *   The library should have minimal to no external dependencies.