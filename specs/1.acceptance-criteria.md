# Acceptance Criteria (EARS Format)

This document outlines the acceptance criteria for the `runnel` library using the EARS (Easy Approach to Requirements Syntax).

## Ubiquitous

*   **U1:** Where the `runnel` library is used, the system shall provide traits for abstracting I/O streams, specifically `StreamIn`, `StreamOut`, and `StreamErr`.
*   **U2:** Where a custom I/O stream is needed, the system shall allow users to implement the `StreamIn`, `StreamOut`, and `StreamErr` traits.
*   **U3:** While multiple threads are accessing a shared stream (like a pipe), the system shall ensure data integrity and prevent race conditions through proper synchronization.

## Event-Driven

*   **E1:** When a user creates a `RunnelIoe` instance without specifying any streams, the system shall provide a default implementation using `stdin`, `stdout`, and `stderr`.
*   **E2:** When a user calls the `.lines()` method on a `StreamIn` object, the system shall return an iterator that yields each line from the stream.
*   **E3:** When data is written to a `PipeOut` stream from one thread, the system shall make that data available to be read from the corresponding `PipeIn` stream in another thread.
*   **E4:** When a line of text is written to a `LinePipeOut` stream from one thread, the system shall make that exact line available to be read from the corresponding `LinePipeIn` stream in another thread.

## State-Driven

*   **S1:** While the system is configured to use the `stringio` implementation, it shall read input from and write output to in-memory string buffers.
*   **S2:** While the system is configured to use the `pipeio` implementation, it shall route byte streams between threads via an in-memory FIFO queue.
*   **S3:** While the system is configured to use the `linepipeio` implementation, it shall route text lines between threads via an in-memory FIFO queue.

## Optional Features

*   **O1:** Where a user needs to configure a custom set of I/O streams, the system shall provide a `RunnelIoeBuilder` to facilitate the construction of the `RunnelIoe` object.
*   **O2:** Where testing of I/O-dependent logic is required, the system shall provide the `stringio` implementation to simulate I/O without external dependencies.
*   **O3:** Where inter-thread communication via byte streams is required, the system shall provide the `pipeio` implementation.
*   **O4:** Where inter-thread communication via text lines is required, the system shall provide the `linepipeio` implementation.